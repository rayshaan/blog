import{_ as k,C as t,c as p,o as e,b1 as h,G as n,j as i,a as l}from"./chunks/framework.w2ptJf3g.js";const C=JSON.parse('{"title":"七.6.BFD与NQA链路检测技术","description":"","frontmatter":{},"headers":[],"relativePath":"views/study/ne/theory/七/6.BFD与NQA链路检测技术.md","filePath":"views/study/ne/theory/七/6.BFD与NQA链路检测技术.md","lastUpdated":1758878470000}'),E={name:"views/study/ne/theory/七/6.BFD与NQA链路检测技术.md"};function r(d,s,g,F,y,o){const a=t("ImageViewer");return e(),p("div",null,[s[0]||(s[0]=h('<h1 id="七-6-bfd与nqa链路检测技术" tabindex="-1">七.6.BFD与NQA链路检测技术 <a class="header-anchor" href="#七-6-bfd与nqa链路检测技术" aria-label="Permalink to &quot;七.6.BFD与NQA链路检测技术&quot;">​</a></h1><h3 id="_1-bfd简介" tabindex="-1">1.BFD简介 <a class="header-anchor" href="#_1-bfd简介" aria-label="Permalink to &quot;1.BFD简介&quot;">​</a></h3><h4 id="_1-网络故障检测遇到的问题" tabindex="-1">1.网络故障检测遇到的问题 <a class="header-anchor" href="#_1-网络故障检测遇到的问题" aria-label="Permalink to &quot;1.网络故障检测遇到的问题&quot;">​</a></h4>',3)),n(a,{src:"/blog/images/study/ne/网络故障检测遇到的问题.png"}),s[1]||(s[1]=h('<br><h4 id="_2-bfd简介" tabindex="-1">2.BFD简介 <a class="header-anchor" href="#_2-bfd简介" aria-label="Permalink to &quot;2.BFD简介&quot;">​</a></h4><ul><li>BFD，双向检测报文</li><li>BFD提供了一个<span class="brown">通用的、标准化的、介质无关的、协议无关</span>的快速故障检测机制，有以下两大优点：</li><li><ul><li>1.对相邻转发引擎之间的通道提供轻负荷、快速故障检测</li></ul></li><li><ul><li>2.用单一的机制对任何介质、任何协议层进行实时检测</li></ul></li><li>BFD是一个简单的&quot;Hello&quot;协议。两个系统之间建立BFD会话通道，并<span class="brown">周期性</span>发送BFD检测报文，如果某个系统在规定的时间内没有收到对端的检测报文，则认为该通道的某个部分发生了故障</li></ul><h4 id="_3-bfd报文结构" tabindex="-1">3.BFD报文结构 <a class="header-anchor" href="#_3-bfd报文结构" aria-label="Permalink to &quot;3.BFD报文结构&quot;">​</a></h4><ul><li>BFD检测是通过维护在两个系统之间建立的BFD会话来实现的，系统通过发送BFD报文建立会话</li><li>BFD控制报文根据场景不同封装不同，报文结构由强制部分和可选的认证字段组成</li></ul>',5)),n(a,{src:"/blog/images/study/ne/BFD报文结构.png"}),s[2]||(s[2]=h('<br><ul><li><span class="green">1.Sta</span>：BFD本地状态</li><li><span class="green">2.Detect Mult</span>：检测超时倍数，用于检测方计算检测超时时间</li><li><span class="green">3.My Discriminator</span>：BFD会话连接本地标识符(Local Discriminator)。发送系统产生的一个唯一的、非0鉴别值，用来区分一个系统的多个BFD会话</li><li><span class="green">4.Your Discriminator</span>：BFD会话连接远端标识符(Remote Discriminator)。从远端系统接收到的鉴别值，这个域直接返回接收到的&quot;My Discriminator&quot;，如果不知道这个值就返回0.</li><li><span class="green">5.Desired Min TX Interval</span>：本地支持的最小BFD报文发送间隔。</li><li><span class="green">6.Required Min RX Interval</span>：本地支持的最小BFD报文接收间隔</li><li><span class="green">7.Required Min Echo RX Interval</span>：本地支持的最小Echo报文接收间隔，单位为微妙(如果本地不支持Echo功能，则设置0)</li></ul><h4 id="_4-bfd会话建立" tabindex="-1">4.BFD会话建立 <a class="header-anchor" href="#_4-bfd会话建立" aria-label="Permalink to &quot;4.BFD会话建立&quot;">​</a></h4>',3)),n(a,{src:"/blog/images/study/ne/BFD会话建立.png"}),s[3]||(s[3]=h('<br><p>BFD会话建立有两种方式，即<span class="green">静态建立BFD会话</span>和<span class="green">动态建立BFD会话</span>。BFD通过控制报文中的本地标识符和远端标识符区分不同的会话。静态和动态创建BFD会话的主要区别在于<span class="brown">Local Discriminator</span>和<span class="brown">Remote Discriminator</span>的配置方式不同。</p><h4 id="_5-bfd会话状态" tabindex="-1">5.BFD会话状态 <a class="header-anchor" href="#_5-bfd会话状态" aria-label="Permalink to &quot;5.BFD会话状态&quot;">​</a></h4><ul><li>BFD会话过程有三种状态：<span class="brown">Down、Init、Up</span>。</li><li>会话状态变化通过BFD报文的<span class="green">State</span>字段传递，系统根据自己本地的会话状态和接收到的对端BFD报文驱动状态改变。</li><li>BFD状态机的建立和拆除都采用三次握手机制</li></ul>',4)),n(a,{src:"/blog/images/study/ne/BFD会话状态.png"}),s[4]||(s[4]=i("br",null,null,-1)),s[5]||(s[5]=i("h4",{id:"_6-bfd-echo功能",tabindex:"-1"},[l("6.BFD Echo功能 "),i("a",{class:"header-anchor",href:"#_6-bfd-echo功能","aria-label":'Permalink to "6.BFD Echo功能"'},"​")],-1)),n(a,{src:"/blog/images/study/ne/BFD Echo功能.png"}),s[6]||(s[6]=i("br",null,null,-1)),s[7]||(s[7]=i("ul",null,[i("li",null,[l("BFD Echo功能也称为"),i("span",{class:"brown"},"BFD回声功能"),l("，是由本地发送BFD Echo报文，远端系统将报文环回的一种检测机制")]),i("li",null,"在两台直接相连的设备中，其中一台设备支持BFD功能(R1)，另一台设备不支持BFD功能(R2)，只支持基本的网络层转发。为了能够快速的检测这两台设备之间的故障，可以在支持BFD功能的设备上创建单臂回声功能的BFD会话。支持BFD功能的设备主动发起回声请求功能，不支持BFD功能的设备接收到该报文后直接将其环回，从而实现转发链路的连通性检测功能。")],-1)),s[8]||(s[8]=i("h3",{id:"_2-bfd联动功能",tabindex:"-1"},[l("2.BFD联动功能 "),i("a",{class:"header-anchor",href:"#_2-bfd联动功能","aria-label":'Permalink to "2.BFD联动功能"'},"​")],-1)),n(a,{src:"/blog/images/study/ne/BFD联动功能.png"}),s[9]||(s[9]=i("br",null,null,-1)),s[10]||(s[10]=i("p",null,"联动功能由监测模块、Track和应用模块三部分组成。",-1)),s[11]||(s[11]=i("ul",null,[i("li",null,"1.监测模块负责对链路状态、网络性能鞥进行监测，并将探测结果通知给Track模块"),i("li",null,"Track模块收到监测模块的探测结果后，及时改变Track项的状态，并通知应用模块"),i("li",null,"应用模块根据Track项的状态，进行相应的处理，从而实现联动")],-1)),s[12]||(s[12]=i("h4",{id:"_1-静态路由与bfd联动",tabindex:"-1"},[l("1.静态路由与BFD联动 "),i("a",{class:"header-anchor",href:"#_1-静态路由与bfd联动","aria-label":'Permalink to "1.静态路由与BFD联动"'},"​")],-1)),n(a,{src:"/blog/images/study/ne/静态路由与BFD联动.png"}),s[13]||(s[13]=i("br",null,null,-1)),s[14]||(s[14]=i("ul",null,[i("li",null,"静态路由自身没有检测机制，如果静态路由存在冗余路径，通过静态路由与BFD联动，当主用路径故障时，实现静态路由的快速切换"),i("li",null,"静态路由与BFD联动应用广泛。如图所示R1是园区网的出口路由器，R1通过两条链路分别连接ISP1和ISP2，正常情况下默认路由经过的链路为指向ISP1的链路，当通往ISP1的链路出现故障的时候，BFD会话能够快速感知，并通知路由器将流量切换到指向ISP2的链路")],-1)),s[15]||(s[15]=i("h5",{id:"配置",tabindex:"-1"},[l("配置 "),i("a",{class:"header-anchor",href:"#配置","aria-label":'Permalink to "配置"'},"​")],-1)),n(a,{src:"/blog/images/study/ne/静态路由与BFD联动配置.png"}),s[16]||(s[16]=h(`<br><p>1.在R1与R2之间建立静态BFD会话</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">R1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] bfd</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">R1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] bfd </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> bind peer </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12.2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GigabitEthernet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 0/0/1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">R1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bfd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">session</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-12] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">discriminator</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> local</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 10</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">R1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bfd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">session</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-12] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">discriminator</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> remote</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 20</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">R1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bfd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">session</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-12] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">commit</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">R2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bfd</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">R2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bfd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 21 </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bind</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> peer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 10.0.12.1 </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GigabitEthernet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 0/0/1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">R2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bfd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">session</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-21] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">discriminator</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> local</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 10</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">R2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bfd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">session</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-21] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">discriminator</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> remote</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 20</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">R2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bfd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">session</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-21] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">commit</span></span></code></pre></div><p>2.在R1配置静态路由并绑定BFD会话</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">R1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] ip route</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">static </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4.4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4.4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 32</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> track bfd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">session </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">12</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">R1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] ip route</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">static </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4.4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4.4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 32</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">13.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> preference </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span></span></code></pre></div><p>3.其他配置略</p><h5 id="配置验证" tabindex="-1">配置验证 <a class="header-anchor" href="#配置验证" aria-label="Permalink to &quot;配置验证&quot;">​</a></h5>`,7)),n(a,{src:"/blog/images/study/ne/静态路由与BFD联动配置验证.png"}),s[17]||(s[17]=i("br",null,null,-1)),s[18]||(s[18]=i("h4",{id:"_2-ospf与bfd联动",tabindex:"-1"},[l("2.OSPF与BFD联动 "),i("a",{class:"header-anchor",href:"#_2-ospf与bfd联动","aria-label":'Permalink to "2.OSPF与BFD联动"'},"​")],-1)),n(a,{src:"/blog/images/study/ne/OSPF与BFD联动.png"}),s[19]||(s[19]=i("br",null,null,-1)),s[20]||(s[20]=i("p",null,"BFD会话建立后会周期性地快速发送BFD报文，如果在检测时间内没有收到BFD报文，则认为该双向转发路径发生了故障，通知被服务的上层应用进行相应的处理",-1)),s[21]||(s[21]=i("ul",null,[i("li",null,"当R1和R2之间链路出现故障，BFD首先快速检测到链路故障，BFD会话状态变为Down并通知R1"),i("li",null,"R1处理邻居Down事件，通知本地OSPF进行邻居不可达，重新进行路由计算，选择通过R3到达R4")],-1)),s[22]||(s[22]=i("h5",{id:"配置-1",tabindex:"-1"},[l("配置 "),i("a",{class:"header-anchor",href:"#配置-1","aria-label":'Permalink to "配置"'},"​")],-1)),n(a,{src:"/blog/images/study/ne/OSPF与BFD联动配置.png"}),s[23]||(s[23]=h(`<br><p>R1配置如下：</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">R1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] bfd</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">R1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GigabitEthernet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 0/0/1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">R1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GigabitEthernet0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/0/1] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ip</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> address</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 10.0.12.1 30</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">R1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ospf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">R1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ospf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-1] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">area</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">R1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ospf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-1-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">area</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-0.0.0.0] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">network</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 10.0.12.0 0.0.0.3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">R1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ospf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-1-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">area</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-0.0.0.0] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">quit</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">R1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ospf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-1] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bfd</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> all</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> interfaces</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> enable</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">R1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ospf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-1] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bfd</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> all</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">interfaces</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> min</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">interval</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 100 </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">min</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">interval</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 100 </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">detect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">multiplier</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 3</span></span></code></pre></div><p>R2和R3配置与R1类似，此处省略</p><h5 id="配置验证-1" tabindex="-1">配置验证 <a class="header-anchor" href="#配置验证-1" aria-label="Permalink to &quot;配置验证&quot;">​</a></h5>`,5)),n(a,{src:"/blog/images/study/ne/OSPF与BFD联动配置验证.png"}),s[24]||(s[24]=h(`<br><h3 id="_3-nqa探测技术" tabindex="-1">3.NQA探测技术 <a class="header-anchor" href="#_3-nqa探测技术" aria-label="Permalink to &quot;3.NQA探测技术&quot;">​</a></h3><ul><li><span class="green">NQA(Network Quality Analysis)网络质量分析</span>，是一种实时的<span class="brown">网络性能探测和统计</span>技术，可以对响应时间、网络抖动、丢包率等网络信息进行统计。NQA能够实时监视网络QoS，在网络发生故障时进行有效的故障诊断和定位</li><li>使用NQA客户端，配置ICMP类型的NQA测试用例</li></ul><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[RouterA] nqa test</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">instance admin icmp</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[RouterA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nqa</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">admin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">icmp] test</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> icmp</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[RouterA-nqa-admin-icmp] destination-address ipv4 10.1.1.2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[RouterA-nqa-admin-icmp] start now</span></span></code></pre></div><ul><li>配置NQA与静态路由联动</li></ul><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[RouterA] ip route</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">static </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 255.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> track nqa admin icmp</span></span></code></pre></div><h3 id="_4-ip-link技术" tabindex="-1">4.IP-Link技术 <a class="header-anchor" href="#_4-ip-link技术" aria-label="Permalink to &quot;4.IP-Link技术&quot;">​</a></h3><ul><li>IP-Link是指FW通过向指定的目的IP周期性地发送探测报文并等待应答，来判断链路是否发生故障</li><li><ul><li>FW发送探测报文后，在<span class="brown">三个探测周期</span>(<span class="green">默认为15s</span>)内未收到响应报文，则认为当前链路发生故障，IP-Link的状态变为Down。随后，FW会进行IP-Link Down相关的后续操作，例如双机热备、主备切换等</li></ul></li><li>在FW上配置静态路由与IP-Link联动</li></ul><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FW_A</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] ip</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">link check enable</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FW_A</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] ip</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">link name test</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FW_A</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">iplink</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">test] source</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ip </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">172.27</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FW_A</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">iplink</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">test] destination </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">172.27</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> mode icmp</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FW_A</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">iplink</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">test] quit</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FW_A</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] ip route</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">static </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">30.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 255.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> track ip</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">link test</span></span></code></pre></div>`,9))])}const u=k(E,[["render",r]]);export{C as __pageData,u as default};
