import{_ as k,C as t,c as p,o as e,j as i,G as l,b1 as n,a}from"./chunks/framework.w2ptJf3g.js";const c=JSON.parse('{"title":"七.4.策略路由","description":"","frontmatter":{},"headers":[],"relativePath":"views/study/ne/theory/七/4.策略路由.md","filePath":"views/study/ne/theory/七/4.策略路由.md","lastUpdated":1758878470000}'),r={name:"views/study/ne/theory/七/4.策略路由.md"};function E(d,s,g,y,F,C){const h=t("ImageViewer");return e(),p("div",null,[s[0]||(s[0]=i("h1",{id:"七-4-策略路由",tabindex:"-1"},[a("七.4.策略路由 "),i("a",{class:"header-anchor",href:"#七-4-策略路由","aria-label":'Permalink to "七.4.策略路由"'},"​")],-1)),s[1]||(s[1]=i("h3",{id:"_1-pbr",tabindex:"-1"},[a("1.PBR "),i("a",{class:"header-anchor",href:"#_1-pbr","aria-label":'Permalink to "1.PBR"'},"​")],-1)),l(h,{src:"/blog/images/study/ne/策略路由.png"}),s[2]||(s[2]=i("br",null,null,-1)),s[3]||(s[3]=i("ul",null,[i("li",null,[a("PBR(Policy-Based Routing，策略路由)：PBR使得网络设备不仅能够基于报文的目的IP地址进行数据转发，更能"),i("span",{class:"brown"},"基于其他元素"),a("进行数据转发，例如源IP地址、源MAC地址、目的MAC地址、源端口号、目的端口号、VLAN-ID等等")]),i("li",null,"用户还可以使用ACL匹配特定的报文，然后针对该ACL进行PBR部署"),i("li",null,[a("若设备部署了PBR，则被匹配的报文优先根据PBR的策略进行转发，即PBR策略的"),i("span",{class:"brown"},"优先级高于"),a("传统路由表")])],-1)),s[4]||(s[4]=i("h4",{id:"_1-命令语法",tabindex:"-1"},[a("1.命令语法 "),i("a",{class:"header-anchor",href:"#_1-命令语法","aria-label":'Permalink to "1.命令语法"'},"​")],-1)),l(h,{src:"/blog/images/study/ne/策略路由PBR命令语法.png"}),s[5]||(s[5]=i("br",null,null,-1)),s[6]||(s[6]=i("h4",{id:"_2-分类",tabindex:"-1"},[a("2.分类 "),i("a",{class:"header-anchor",href:"#_2-分类","aria-label":'Permalink to "2.分类"'},"​")],-1)),s[7]||(s[7]=i("h5",{id:"接口pbr",tabindex:"-1"},[a("接口PBR "),i("a",{class:"header-anchor",href:"#接口pbr","aria-label":'Permalink to "接口PBR"'},"​")],-1)),l(h,{src:"/blog/images/study/ne/接口PBR.png"}),s[8]||(s[8]=i("br",null,null,-1)),s[9]||(s[9]=i("ul",null,[i("li",null,[a("接口PBR只针对"),i("span",{class:"green"},"转发的报文"),a("起作用，对本地始发的报文无效")]),i("li",null,"接口PBR调用再接口下，对接口的入方向报文生效。缺省情况下，设备按照路由表的下一跳进行报文转发，如果配置了接口PBR，则设备按照接口PBR指定的下一跳进行转发")],-1)),s[10]||(s[10]=i("h5",{id:"本地pbr",tabindex:"-1"},[a("本地PBR "),i("a",{class:"header-anchor",href:"#本地pbr","aria-label":'Permalink to "本地PBR"'},"​")],-1)),l(h,{src:"/blog/images/study/ne/本地PBR.png"}),s[11]||(s[11]=i("br",null,null,-1)),s[12]||(s[12]=i("ul",null,[i("li",null,[a("本地PBR对"),i("span",{class:"green"},"本地始发"),a("的流量生效，如：本地始发的ICMP报文")]),i("li",null,"本地PBR在系统视图调用")],-1)),s[13]||(s[13]=i("h4",{id:"_3-案例",tabindex:"-1"},[a("3.案例 "),i("a",{class:"header-anchor",href:"#_3-案例","aria-label":'Permalink to "3.案例"'},"​")],-1)),l(h,{src:"/blog/images/study/ne/PBR案例1.png"}),s[14]||(s[14]=n(`<br><p>需求：</p><ul><li>内网存在两个网段，网段1：10.1.1.0/24，网段2：10.1.2.0/24，在RTA的GE0/0/0接口部署PBR，实现网段1访问Internet通过ISP1、网段2访问Internet通过ISP2</li><li>RTA上挂了一台服务器，要求在RTA上部署的策略路由不影响内网用户访问该服务器</li></ul><p>实现：</p><ul><li>1.配置ACL 3000，其中rule1 deny匹配网段1访问服务器的流量，rule2匹配网段1访问Internet的流量</li></ul><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] acl number </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">acl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">adv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] rule </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> deny ip source </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.255</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> destination </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3.254</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">acl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">adv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] rule </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> permit ip source </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.255</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> destination </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span></code></pre></div><ul><li>2.配置ACL 3001，其中rule1 deny匹配网段2访问服务器的流量，rule2匹配网段2访问Internet的流量</li></ul><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] acl number </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3001</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">acl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">adv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3001</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] rule </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> deny ip source </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.255</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> destination </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3.254</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">acl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">adv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3001</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] rule </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> permit ip source </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.255</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> destination </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span></code></pre></div><ul><li>3.创建PBR hcip，创建节点10，调用ACL 3000，指定其转发下一跳为202.1.2.3</li></ul><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] policy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">based</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">route hcip permit node </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">policy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">based</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">route</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hcip</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">match acl </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">policy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">based</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">route</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hcip</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] apply ip</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">address next</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hop </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">202.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.3</span></span></code></pre></div><ul><li>4.创建PBR hcip节点20，调用ACL 3001，指向其转发下一跳为154.1.2.3</li></ul><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] policy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">based</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">route hcip permit node </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">policy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">based</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">route</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hcip</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">match acl </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3001</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">policy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">based</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">route</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hcip</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">20</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] apply ip</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">address next</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">hop </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">154.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.3</span></span></code></pre></div><ul><li>5.在GE0/0/0接口调用PBR hcip</li></ul><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GigabitEthernet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 0/0/0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">RTA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GigabitEthernet0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/0/0] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ip</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> policy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">based</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">route</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> hcip</span></span></code></pre></div><h4 id="_4-策略路由pbr与路由策略route-policy区别" tabindex="-1">4.策略路由PBR与路由策略Route-Policy区别 <a class="header-anchor" href="#_4-策略路由pbr与路由策略route-policy区别" aria-label="Permalink to &quot;4.策略路由PBR与路由策略Route-Policy区别&quot;">​</a></h4><table tabindex="0"><thead><tr><th>名称</th><th>操作对象</th><th>描述</th></tr></thead><tbody><tr><td>路由策略（Route-Policy）</td><td>路由信息</td><td>路由策略是一套用于对路由信息进行过滤、属性设置等操作的方法，通过对路由的操作或控制，来影响数据报文的转发路径</td></tr><tr><td>策略路由（PBR）</td><td>数据报文</td><td>PBR直接对数据报文进行操作，通过多种手段匹配感兴趣的报文，然后执行丢弃或强制转发路径等操作</td></tr></tbody></table><h3 id="_3-mqc" tabindex="-1">3.MQC <a class="header-anchor" href="#_3-mqc" aria-label="Permalink to &quot;3.MQC&quot;">​</a></h3><ul><li>MQC(Modular Qos Command-Line Interface，模块化QoS命令行)是指通过将具有某类共同特征的数据流划分为一类，并为同一类数据流提供相同的服务，也可以对不同类的数据流提供不同的服务</li><li>MQC包含三个要素</li><li><ul><li><span class="brown">流分类(traffic classifier)</span></li></ul></li><li><ul><li><span class="brown">流行为(traffic behavior)</span></li></ul></li><li><ul><li><span class="brown">流策略(traffic policy)</span></li></ul></li><li>MQC的流行为<span class="brown">支持重定向报文</span>，因此可以使用MQC实现IP单播策略路由</li></ul>`,18)),l(h,{src:"/blog/images/study/ne/MQC.png"}),s[15]||(s[15]=i("br",null,null,-1)),s[16]||(s[16]=i("h4",{id:"流分类",tabindex:"-1"},[a("流分类 "),i("a",{class:"header-anchor",href:"#流分类","aria-label":'Permalink to "流分类"'},"​")],-1)),s[17]||(s[17]=i("p",null,"流分类：定义一组流量匹配规则，以对报文进行分类",-1)),l(h,{src:"/blog/images/study/ne/MQC流分类.png"}),s[18]||(s[18]=i("br",null,null,-1)),s[19]||(s[19]=i("h4",{id:"流行为",tabindex:"-1"},[a("流行为 "),i("a",{class:"header-anchor",href:"#流行为","aria-label":'Permalink to "流行为"'},"​")],-1)),s[20]||(s[20]=i("p",null,"流行为：用来定义执行的动作，支持报文过滤、重标记优先级、重定向、流量统计等",-1)),l(h,{src:"/blog/images/study/ne/MQC流行为.png"}),s[21]||(s[21]=i("br",null,null,-1)),s[22]||(s[22]=i("h4",{id:"流策略",tabindex:"-1"},[a("流策略 "),i("a",{class:"header-anchor",href:"#流策略","aria-label":'Permalink to "流策略"'},"​")],-1)),s[23]||(s[23]=i("p",null,[a("流策略：流策略支持在接口上调用"),i("br"),a(" 流策略存在方向(inbound、outbound)的概念，策略中的流行为匹配入、出方向的报文，对匹配中的报文执行相应的流动作")],-1)),l(h,{src:"/blog/images/study/ne/MQC流策略.png"}),s[24]||(s[24]=n(`<br><h4 id="基本配置" tabindex="-1">基本配置 <a class="header-anchor" href="#基本配置" aria-label="Permalink to &quot;基本配置&quot;">​</a></h4><p>1.创建流分类</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Huawei] traffic classifier classifier</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name [operator {and | or}]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">//缺省情况下，流分类中各规则之间的关系为&quot;或(or)&quot;</span></span></code></pre></div><p>2.创建流行为</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Huawei] traffic behavior behavior</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 根据实际情况定义流行为中的动作，只要各动作不冲突，都可以在同一流行为中配置</span></span></code></pre></div><p>3.创建流策略</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Huawei] traffic policy policy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Huawei</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">trafficpolicy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">policyname] classifier classifier</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name behavior behavior</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name</span></span></code></pre></div><h4 id="案例" tabindex="-1">案例 <a class="header-anchor" href="#案例" aria-label="Permalink to &quot;案例&quot;">​</a></h4>`,9)),l(h,{src:"/blog/images/study/ne/MQC实现策略路由.png"}),s[25]||(s[25]=n(`<br><p>需求：</p><ul><li>内网存在两个网段，网段1：10.1.1.0/24，网段2：10.1.2.0/24，在RTA上通过MQC实现策略路由，实现网段1访问Internet通过ISP1、网段2访问Internet通过ISP2</li><li>将MQC调用再RTA的GE0/0/0接口</li></ul><p>实现：</p><ul><li>1.配置ACL3000， 3001分配匹配网段1、网段2访问Internet的流量</li></ul><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] acl number </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">acl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">adv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] rule </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> permit ip source </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.255</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> destination any</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] acl number </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3001</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">acl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">adv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3001</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] rule </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> permit ip source </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.255</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> destination any</span></span></code></pre></div><ul><li>2.创建流分类1、2分别匹配ACL3000、ACL3001</li></ul><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] traffic classifier </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">classifier</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">match acl </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] traffic classifier </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">classifier</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">match acl </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3001</span></span></code></pre></div><ul><li>3.创建流行为1、2分别执行将报文重定向到202.1.2.3、154.1.2.3的动作</li></ul><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] traffic behavior </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">behavior</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] redirect ip</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nexthop </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">202.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] traffic behavior </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">behavior</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] redirect ip</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nexthop </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">154.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.3</span></span></code></pre></div><ul><li>4.创建流策略hcip，将流分类1、2与流行为1、2关联</li></ul><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] traffic policy Redirect</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">trafficpolicy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Redirect] classifier </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> behavior </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">trafficpolicy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Redirect] classifier </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> behavior </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span></span></code></pre></div><ul><li>5.在GE0/0/0接口调用MQC</li></ul><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">RTA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GigabitEthernet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 0/0/0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">RTA</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GigabitEthernet0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/0/0] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">traffic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">policy</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Redirect</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> inbound</span></span></code></pre></div><h4 id="过滤流量案例" tabindex="-1">过滤流量案例 <a class="header-anchor" href="#过滤流量案例" aria-label="Permalink to &quot;过滤流量案例&quot;">​</a></h4>`,15)),l(h,{src:"/blog/images/study/ne/MQC过滤流量.png"}),s[26]||(s[26]=n(`<br><p>需求：部门1、2、3的网关都在RTA上，现要求在RTA上使用MQC限制部门2与部门3之间互相访问 <br> 实现：</p><ul><li>1.配置ACL匹配部门2访问部门3的流量</li></ul><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Huawei] acl number </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Huawei</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">acl</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">adv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] rule </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> permit ip source </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.255</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> destination </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.255</span></span></code></pre></div><ul><li>2.创建流分类2_3、流行为2_3</li></ul><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Huawei] traffic classifier </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2_3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Huawei</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">classifier</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2_3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">match acl </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Huawei] traffic behavior </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2_3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Huawei</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">behavior</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2_3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] deny</span></span></code></pre></div><ul><li>3.创建流策略，绑定流分类2_3、流行为2_3</li></ul><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Huawei] traffic policy </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2_3</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Huawei</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">trafficpolicy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2_3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] classifier </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2_3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> behavior </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2_3</span></span></code></pre></div><ul><li>4.在接口GE0/0/1入向调用流策略2_3</li></ul><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Huawei] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GigabitEtherent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 0/0/1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Huawei</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GigabitEtherent0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/0/1] </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">traffic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">-</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">policy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> 2</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">_3</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> inbound</span></span></code></pre></div><div class="green"> 为匹配ACL规定的报文指定报文过滤动作时，如果此ACL中的rule规则配置为permit，则设备对此报文采取的动作由流行为中配置的deny或permit决定。如果此ACL中的rule规则配置为deny，则无论流行为中配置了deny或permit，此报文都会被丢弃 </div>`,11))])}const u=k(r,[["render",E]]);export{c as __pageData,u as default};
