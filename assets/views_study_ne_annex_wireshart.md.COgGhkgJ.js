import{_ as n,C as l,c as k,o as p,j as i,G as t,b1 as e,a as h}from"./chunks/framework.BbzeyoJx.js";const F=JSON.parse('{"title":"Wireshart抓包理论","description":"","frontmatter":{},"headers":[],"relativePath":"views/study/ne/annex/wireshart.md","filePath":"views/study/ne/annex/wireshart.md","lastUpdated":1759302708000}'),d={name:"views/study/ne/annex/wireshart.md"};function r(E,s,g,y,o,C){const a=l("ImageViewer");return p(),k("div",null,[s[0]||(s[0]=i("h1",{id:"wireshart抓包理论",tabindex:"-1"},[h("Wireshart抓包理论 "),i("a",{class:"header-anchor",href:"#wireshart抓包理论","aria-label":'Permalink to "Wireshart抓包理论"'},"​")],-1)),s[1]||(s[1]=i("h3",{id:"_1-功能界面介绍",tabindex:"-1"},[h("1.功能界面介绍 "),i("a",{class:"header-anchor",href:"#_1-功能界面介绍","aria-label":'Permalink to "1.功能界面介绍"'},"​")],-1)),t(a,{src:"/blog/images/study/ne/Wireshart功能界面.png"}),s[2]||(s[2]=e(`<br><h3 id="_2-捕获过滤器" tabindex="-1">2.捕获过滤器 <a class="header-anchor" href="#_2-捕获过滤器" aria-label="Permalink to &quot;2.捕获过滤器&quot;">​</a></h3><h4 id="_1-表达式" tabindex="-1">1.表达式 <a class="header-anchor" href="#_1-表达式" aria-label="Permalink to &quot;1.表达式&quot;">​</a></h4><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tcp dst port </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3128</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">       // 捕捉目的TCP端口为3128的封包</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ip src host </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.1</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 捕捉来源IP地址为10.1.1.1的封包</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">host </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.3</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">           // 捕捉目的或来源IP地址为10.1.2.3的封包</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">src portrange </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2000</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2500</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 捕捉来源为UDP或TCP，并且端口号在2000至2500范围内的封包</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">not icmp                </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 捕捉除了icmp以外的所有封包(icmp通常被ping工具使用)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 捕捉来源IP地址为10.7.2.12，但目的地不是10.200.0.0/16的封包</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">src host </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.7</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> and not dst net </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 捕捉来源IP地址为10.4.1.12或者来源网络为10.6.0.0/16，目的地TCP端口号在200至10000之间，并且目的位于网络10.0.0.0/8内的所有封包</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(src host </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.12</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> or src net </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) and tcp dst portrange </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> and dst net </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8</span></span></code></pre></div><h4 id="_2-注意事项" tabindex="-1">2.注意事项 <a class="header-anchor" href="#_2-注意事项" aria-label="Permalink to &quot;2.注意事项&quot;">​</a></h4><ul><li>当使用关键字作为值时，需使用反斜杠转义&quot;&quot;.</li><li>&quot;ether proto \\ip&quot;(与关键字&quot;ip&quot;相同)，这样写将会以ip协议作为目标</li><li>&quot;ip proto \\icmp&quot;(与关键字&quot;icmp&quot;相同)，这样写将会以ping工具常用的icmp作为目标</li></ul><h3 id="_3-显示过滤器" tabindex="-1">3.显示过滤器 <a class="header-anchor" href="#_3-显示过滤器" aria-label="Permalink to &quot;3.显示过滤器&quot;">​</a></h3><h4 id="_1-运算符" tabindex="-1">1.运算符 <a class="header-anchor" href="#_1-运算符" aria-label="Permalink to &quot;1.运算符&quot;">​</a></h4><p>比较运算符：</p><table tabindex="0"><thead><tr><th>英文写法</th><th>C语言写法</th><th>含义</th></tr></thead><tbody><tr><td>eq</td><td>==</td><td>等于</td></tr><tr><td>ne</td><td>!=</td><td>不等于</td></tr><tr><td>gt</td><td>&gt;</td><td>大于</td></tr><tr><td>lt</td><td>&lt;</td><td>小于</td></tr><tr><td>ge</td><td>&gt;=</td><td>大于等于</td></tr><tr><td>le</td><td>&lt;=</td><td>小于等于</td></tr></tbody></table><p>逻辑运算符：</p><table tabindex="0"><thead><tr><th>英文写法</th><th>C语言写法</th><th>含义</th></tr></thead><tbody><tr><td>and</td><td>&amp;&amp;</td><td>逻辑与</td></tr><tr><td>or</td><td>||</td><td>逻辑或</td></tr><tr><td>xor</td><td>^</td><td>逻辑异或</td></tr><tr><td>not</td><td>!</td><td>逻辑非</td></tr></tbody></table><h4 id="_2-表达式" tabindex="-1">2.表达式 <a class="header-anchor" href="#_2-表达式" aria-label="Permalink to &quot;2.表达式&quot;">​</a></h4><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">snmp </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dns </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> icmp </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 显示SNMP或DNS或ICMP封包</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ip.addr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.1</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 显示来源或目的IP地址为10.1.1.1的封包</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 显示来源部位10.1.2.3 或者 目的不为10.4.5.6的封包</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ip.src </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> or ip.dst </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5.6</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 显示来源部位10.1.2.3 并且 目的不为10.4.5.6的封包</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ip.src </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> and ip.dst </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5.6</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tcp.port </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 25</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // 显示来源或目的TCP端口号为25的封包</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tcp.dstport </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 25</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   // 显示目的TCP端口号为25的封包</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tcp.flags           </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 显示包含TCP标志的封包</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tcp.flags.syn </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0x02</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 显示包含TCP SYN标志的封包</span></span></code></pre></div><h4 id="_3-注意事项" tabindex="-1">3.注意事项 <a class="header-anchor" href="#_3-注意事项" aria-label="Permalink to &quot;3.注意事项&quot;">​</a></h4><ul><li>如果过滤器的语法是正确的，表达式的背景呈绿色</li><li>如果呈红色，说明表达式有误</li></ul>`,16)),t(a,{src:"/blog/images/study/ne/显示过滤器注意事项.png"}),s[3]||(s[3]=i("br",null,null,-1))])}const u=n(d,[["render",r]]);export{F as __pageData,u as default};
