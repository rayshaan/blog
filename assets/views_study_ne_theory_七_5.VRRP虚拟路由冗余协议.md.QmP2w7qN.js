import{_ as t,C as e,c as p,o as h,b1 as n,G as l,j as i,a as r}from"./chunks/framework.w2ptJf3g.js";const b=JSON.parse('{"title":"七.5.VRRP虚拟路由冗余协议","description":"","frontmatter":{},"headers":[],"relativePath":"views/study/ne/theory/七/5.VRRP虚拟路由冗余协议.md","filePath":"views/study/ne/theory/七/5.VRRP虚拟路由冗余协议.md","lastUpdated":1752226003000}'),k={name:"views/study/ne/theory/七/5.VRRP虚拟路由冗余协议.md"};function d(o,s,R,u,P,g){const a=e("ImageViewer");return h(),p("div",null,[s[0]||(s[0]=n(`<h1 id="七-5-vrrp虚拟路由冗余协议" tabindex="-1">七.5.VRRP虚拟路由冗余协议 <a class="header-anchor" href="#七-5-vrrp虚拟路由冗余协议" aria-label="Permalink to &quot;七.5.VRRP虚拟路由冗余协议&quot;">​</a></h1><h3 id="_1-简介" tabindex="-1">1.简介 <a class="header-anchor" href="#_1-简介" aria-label="Permalink to &quot;1.简介&quot;">​</a></h3><ul><li>VRRP能够在不改变组网的情况下，将多台路由器虚拟成一个虚拟路由器，通过配置虚拟路由器的IP地址为默认网关，实现网关的备份</li><li>协议版本：VRRPv2(常用)和VRRPv3</li><li>VRRPv2仅适用于IPv4网络，VRRPv3适用于IPv4和IPv6网络</li><li>VRRP协议报文：<span class="brown">Adverstsement报文，其目的地址是224.0.0.18，目的MAC地址是01-00-5e-00-00-12，IP协议号是112</span></li></ul><h3 id="_2-基本概念" tabindex="-1">2.基本概念 <a class="header-anchor" href="#_2-基本概念" aria-label="Permalink to &quot;2.基本概念&quot;">​</a></h3><ul><li><span class="brown">Priority</span>：设备在备份组中的优先级，自动取值范围是0 ~ 255，手动取值范围为1 ~ 254。</li><li><ul><li>0表示设备停止参与VRRP备份组，用来使备份设备尽快成为Master设备，而不必等到计时器超时</li></ul></li><li><ul><li>255则保留给IP地址拥有者，无法手工配置；设备缺省优先级值是100</li></ul></li><li><span class="brown">vrid</span>：虚拟路由器的标识，需手工指定，范围1-255</li><li><span class="brown">优先级大的IP地址大</span>的一个虚拟路由器拥有一个虚拟MAC地址</li></ul><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">IPv4：</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">00</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">00</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5E-00</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">01</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">VRID</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">IPv6：</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">00</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">00</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5E-00</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">02</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">VRID</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="_3-vrrp基本结构" tabindex="-1">3.VRRP基本结构 <a class="header-anchor" href="#_3-vrrp基本结构" aria-label="Permalink to &quot;3.VRRP基本结构&quot;">​</a></h3>`,7)),l(a,{src:"/blog/images/study/ne/VRRP基本结构.png"}),s[1]||(s[1]=i("br",null,null,-1)),s[2]||(s[2]=i("h3",{id:"_4-vrrp状态机",tabindex:"-1"},[r("4.VRRP状态机 "),i("a",{class:"header-anchor",href:"#_4-vrrp状态机","aria-label":'Permalink to "4.VRRP状态机"'},"​")],-1)),l(a,{src:"/blog/images/study/ne/VRRP状态机.png"}),s[3]||(s[3]=i("br",null,null,-1)),s[4]||(s[4]=i("ul",null,[i("li",null,[r("优先级0和255是"),i("span",{class:"brown"},"不可以手动设置的"),r("，只有虚拟IP和接口IP为同一个IP地址时，该设备的优先级会自动调为255。")]),i("li",null,"Master设备要退出该VRRP时，会发送优先级为0的VRRP通告报文")],-1)),s[5]||(s[5]=i("h3",{id:"_5-vrrp主备备份工作过程",tabindex:"-1"},[r("5.VRRP主备备份工作过程 "),i("a",{class:"header-anchor",href:"#_5-vrrp主备备份工作过程","aria-label":'Permalink to "5.VRRP主备备份工作过程"'},"​")],-1)),l(a,{src:"/blog/images/study/ne/VRRP主备备份工作过程.png"}),s[6]||(s[6]=i("br",null,null,-1)),s[7]||(s[7]=i("h3",{id:"_6-vrrp负载分担工作过程",tabindex:"-1"},[r("6.VRRP负载分担工作过程 "),i("a",{class:"header-anchor",href:"#_6-vrrp负载分担工作过程","aria-label":'Permalink to "6.VRRP负载分担工作过程"'},"​")],-1)),l(a,{src:"/blog/images/study/ne/VRRP负载分担工作过程.png"}),s[8]||(s[8]=n('<br><h3 id="_7-vrrp主备路由器切换过程" tabindex="-1">7.VRRP主备路由器切换过程 <a class="header-anchor" href="#_7-vrrp主备路由器切换过程" aria-label="Permalink to &quot;7.VRRP主备路由器切换过程&quot;">​</a></h3><p>如Master发生故障，则主备切换的过程：</p><ul><li>Backup在<span class="brown">Master_Down_Interval</span>时间内未收到Master发送的状态通告报文，则立即成为Master</li><li>设备的状态变成Master后，会立刻发送<span class="brown">免费ARP</span>来刷新交换机上的MAC表项，从而把用户的流量引到此设备上来，整个过程对用户完全透明</li></ul><p>如原Master故障恢复，则主备回切的过程：</p><ul><li>现Matser(原Backup)会发送VRRP通告报文，原Master收到该报文后比较优先级</li><li>如果优先级大于自己的优先级，则M现atser(原Backup)会继续工作。</li><li>如果优先级小于自己，则自己立即抢占成为Master</li><li>此特性叫抢占特性，默认延时为0，为防止丢包，一般设置为10 ~ 60秒</li></ul><h3 id="_8-vrrp故障场景" tabindex="-1">8.VRRP故障场景 <a class="header-anchor" href="#_8-vrrp故障场景" aria-label="Permalink to &quot;8.VRRP故障场景&quot;">​</a></h3>',7)),l(a,{src:"/blog/images/study/ne/VRRP故障场景.png"}),s[9]||(s[9]=i("br",null,null,-1)),s[10]||(s[10]=i("ul",null,[i("li",null,"RouterA或连接RouterB的接口发生故障时都会引起VRRP主备切换"),i("li",null,"而RouterA的上行链路故障不会引起VRRP主备切换，这样会造成HostA访问Internet的流量在RouterA处被丢弃，所以需要使VRRP设备能够感知到上行链路故障，并且及时做主备切换")],-1)),s[11]||(s[11]=i("p",null,"解决方案：",-1)),s[12]||(s[12]=i("div",{class:"green"}," 利用VRRP的联动功能监视上行接口或链路故障，主动进行主备切换(主动降低优先级) ",-1)),l(a,{src:"/blog/images/study/ne/VRRP配置.png"}),s[13]||(s[13]=i("br",null,null,-1))])}const v=t(k,[["render",d]]);export{b as __pageData,v as default};
